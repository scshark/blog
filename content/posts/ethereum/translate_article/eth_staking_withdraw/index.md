---
title: "以太坊质押提款"
date: 2023-03-20T11:30:11+08:00
lastmod: 2023-03-20T11:30:11+08:00
draft: false
authors: ["scshark"]
description: "以太坊官网发布了以太坊质押提款指南，详细介绍了以太坊质押提款的相关事项，包括质押奖励的发放和领取，质押提款步骤、提款时间等，并就一些常见问题进行了解答"
tags: ["Ethereum","Staking","Cryptocurrency"]
categories: ["Ethereum"]
series: []

hiddenFromHomePage: false
hiddenFromSearch: false

featuredImage: "https://blog.cdn.scshark.com/scshark/2023-03-20/16792838056677.jpg"
featuredImagePreview: "https://blog.cdn.scshark.com/scshark/2023-03-20/16792838056677.jpg"

toc:
  enable: true
math:
  enable: false
lightgallery: true
license: ""

---

<!--more-->

**要点**

- 上海升级支持以太坊的质押提款；

- 验证者必须提供提现地址才能启用；

- 奖励每隔几天自动发放一次；

- 完全退出质押的验证者将会收到他们的结余。



**时间**

2023-4月份

通过 **Shanghai/Capella** 升级，用户可进行质押代币的提取。此次以太坊网络升级预计将在 2023 年上半年进行。

**Shanghai/Capella** 升级允许用户在以太坊上提款，并解锁 ETH 提现奖励。奖励将会自动、定期地发送到与每个验证者链接的提现地址。用户也可完全退出质押，解锁全部的余额。

## 质押奖励 {#staking-reward}

**有效余额为 32 ETH 的活跃验证者帐户获得的奖励支付会被自动处理。**

通过奖励获得的任何超过 32 ETH 的余额不会为本金加码，也不会增加这个验证者在网络上的权重，因此每隔几天奖励就会被自动提取出来。除了需要提供一次提款地址外，这些奖励不需要验证者的任何操作。这些全都是在共识层启动的，因此每一步都无需支付 Gas 费（交易费用）。

## 发展过程 {#development-process}

在过去的几年里，以太坊经历了几次网络升级，从能源密集型挖矿过渡到了一个由 ETH 自身保护的网络。参与以太坊的共识层现在被称为“**质押（staking）**”，因为参与者自愿锁定 ETH，将参与网络的能力“**押注（at stake）**”。遵守规则的用户将获得奖励，而试图作弊的可能会受到惩罚。自 2020 年 11 月推出质押存款合约以来，一些勇敢的以太坊先驱遵循网络规则，自愿地锁定资金以激活“验证器”，即有权正式证明和提出区块的账户。

在上海升级之前，您无法使用或获得质押的 ETH。但现在，你可以选择自动将奖励存入一个提供的账户中，也可以随时提取你质押的 ETH。

## 准备工作 {#get-ready}

### 当前质押者{#staker}

一些用户可能在最初设置存款时提供了提款地址——这些用户无需再做任何事情。但大多数质押者在进行初始存款时没有提供提款地址，因为需要更新一下。**Zhejiang Testnet Launchpad**上有关于何时以及如何这样做的说明。

你可以在这里输入验证器索引号，以查看是否仍需要更新这些凭证（这可以在你的 **client logs** 中找到）:



{{< image src="https://blog.cdn.scshark.com/scshark/2023-03-20/16792886678496.jpg" caption="验证器索引号" >}}

### 新质押者（还没有存款）{#new-staker}

默认情况下，希望自动启用奖励支付和提款功能的新质押者在使用 **Staking Deposit CLI** 工具生成验证器密钥时，应该提供他们控制的以太坊提款地址。

这在进行存款时是不需要的，但可以避免以后在解锁资金时更新这些密钥。

**Staking Launchpad** 将指导你进行成功质押。


## 重要说明 {#important-explanation}

提供提款地址是任何验证者帐户在有资格从其余额中提取 ETH 之前的必要步骤。

每个验证者帐户一次只能指定一个提款地址。一旦选择了一个地址并提交给 **Beacon** 链，就不能再撤销或更改。**在提交之前，请仔细检查所提供地址的所有权和准确性。**


{{< image src="https://blog.cdn.scshark.com/scshark/2023-03-20/16792886678496.jpg" caption="一旦选择了一个地址并提交,不能再撤销或更改" >}}

在此期间，你的资金不会因为不提供这个而受到威胁。**添加取款凭据失败将只会使 ETH 锁定在验证者帐户中，直到提供提款地址为止。**


## 完全退出质押 {#quit-staking}

在从验证者账户余额中转移任何资金之前，都需要提供提款地址。

**希望完全退出质押并撤回全部余额的用户还必须签署并广播一条带有验证者密钥的“自愿退出（`voluntary exit`）”的消息，这将启动退出质押的过程。** 这是通过验证者客户端完成的，并会提交给信标节点，但不需要支付 Gas 费。 


验证者退出质押的过程所花费的时间是不同的，这取决于有多少验证者在同一时间退出。一旦完成，该帐户将不再负责执行验证者的网络职责，也不再有资格获得奖励，并且他们的 ETH 也不会再被用于 **“押注”** 。**此时，该帐户将被标记为“withdrawable”。**

**在账户被标记为 `“withdrawable”` 后，用户只需提交提款凭证，剩下的等待即可。这些账户会被区块提议者自动且持续地扫描符合条件的资金。您的帐户余额将在下一次扫描期间全额转移（也可称为“全额提款”）。** 

## 何时可提？{#when-withdrawable}

提款功能将通过两部分同时进行的网络升级来实现：**上海 + Capella**


## 上海升级 {#upgrade-shanghai}

计划于 2023 年第一季度 / 第二季度进行的上海升级将启用提款功能（与任何升级一样，时间可能会发生变化）。**这使得之前被质押的 ETH 可以存入执行层账户，关闭质押流动性的循环，并使得在以太坊构建可持续、可扩展、安全的去中心化生态系统的旅程又迈出了一步。**


**上海升级标志着未定义的 ETH 质押锁定期的结束**。用户可以自由地：

- 质押 ETH；
- 获得将自动分配的 ETH 奖励；
- 取消质押并重新获得他们的全部余额；
- 当然，也可以重新质押，重新注册，以获得更多的奖励。


## Capella 升级 {#upgrade-capella}

为了使上海升级生效，必须同时对 **Beacon** 链进行名为 **Capella** 的升级。节点运营利益相关者应密切关注客户端通信渠道，以了解计划于 2023 年第一季度 / 第二季度进行的客户端更新。一旦 **Capella** 升级启动，需要更新验证者提款密钥的质押者可以广播此消息。


## 提款付款如何运作？{#how-withdraw-work}

给定的验证者是否有资格提现是由验证者帐户本身的状态决定的。在任何给定的时间里，都不需要用户输入来确定一个帐户是否应该发起提款-----**整个过程由共识层在连续循环中自动完成**。

## 验证者“扫描” {#validator-scan}

当一个验证者被安排提议下一个区块时，需要构建一个提款队列，最多只能有 16 个符合条件的提款。**这是通过最初从验证器索引 0 开始，根据协议规则确定该帐户是否有合格的提款，并将其添加到队列中（如果有的话）来完成的**。提议下一个区块的验证器将从上一个区块停止的地方继续，无限地按顺序推进。

> 想象一个模拟时钟。时钟上的指针指向小时，朝着一个方向前进，不会跳过任何小时，最终在到达最后一个数字后再次绕回到起点。
>
> 现在，假设时钟不是 1 到 12，而是 0 到 N（截至 2023 年 1 月，已经在 Beacon 链上注册的验证者帐户总数超过了 50 万个）。
> 
> 时钟上的指针指向下一个验证者，其需要被检查是否有合格提款。它从 0 开始，并在不跳过任何帐户的情况下进行整个过程。当到达最后一个验证者时，循环继续，周而复始。


## 检查账户是否有提款 {#check-validator-withdraw}

当提议者检查验证者可能的提款时，每个被检查的验证者都会根据一系列简短的问题进行评估，以确定是否应该触发提款，以及如果是的话，应该提取多少 ETH。

问题包括：

- 1、是否提供了提款地址？如果没有，则跳过该帐户，不启动提现。
- 2、验证者是否退出并且账户被标记为**“withdrawable”** ？如果验证者已经完全退出，且帐户处于 **“withdrawable”** 的阶段，那么将处理完全退出。这将把余额全部转到提款地址。
- 3、**有效余额是否达到了 32 ETH？** 如果帐户有提款凭据，没有完全退出，并且有 32 ETH 以上的奖励等待，则将处理部分提款，**仅将 32 ETH 以上的奖励转移到用户的提款地址**。

在此过程中，只有两个操作会产生直接影响：

- 一是提供提款凭证以支持任何形式的提款；
- 二是退出网络，这将触发完全提款。

## Gas 费 {#gas-fee}

**这种质押提款的方法避免了需要质押者手动提交要求提取特定数量的 ETH 的交易。** 这也意味着不需要 **Gas 费用（交易费用）**，取款也不会对现有的执行层区块空间造成威胁。

## 获得质押奖励的频率 {#get-reward-rate}

一个区块最多可以处理 16 次提款。按照这个速度，每天可以处理 115,200 个验证者提款（假设没有遗漏区块）。

如上所述，没有合格提款的验证者将被跳过，从而减少完成扫描的时间。


展开这个计算，我们可以估计出处理给定数量的提款所需的时间：


{{< link src="https://blog.cdn.scshark.com/scshark/2023-03-20/16792920088236.jpg" caption="（注：左边为取款数量，右边为完成时间。）" >}}


**正如您所看到的，随着网络上的验证者越来越多，处理速度也会变慢。**



## 常见问题解答 {#question}

{{< admonition type="question" title="常见问题解答" >}}

1. 一旦我提供了一个提款地址，是否可以将其更改为另一个？

- 不可以，提供提现凭证的流程是一次性的，一旦提交就不能更改。

---

2. 为什么提现地址只能设置一次?

- **通过设置执行层提款地址，该验证者的提现凭证已经被永久更改。** 这意味着旧的凭据将不再有效，新的凭据将直接指向执行层帐户。提**款地址可以是智能合约（由其代码控制），也可以是外部拥有的账户（EOA，由其私钥控制）。** 目前，这些帐户无法将消息返回到共识层，以证明验证者凭证发生了变化。**并且添加此功能将为协议增加不必要的复杂性**。

- 作为更改特定验证者的提款地址的替代方案，用户可以选择将智能合约设置为可以处理密钥轮替的提款地址，例如 Safe。将资金设置为自己 EOA 的用户可以执行完全退出，以撤回所有的质押资金，然后使用新的凭证重新进行质押。

---

3. 如果我参与流动性质押衍生品或流动池质押怎么办？

- 如果你参与质押池或持有流动性质押衍生品，那么应该向提供商了解更多关于质押提款将如何影响你的安排的细节，因为每种服务的操作都不一样。
- 一般来说，用户可能没有什么需要做的，这些服务将不再受到无法提取奖励或退出验证者资金的限制。**这意味着用户现在可以决定赎回他们质押的 ETH，或更改他们使用的质押提供商。** 如果一个特定的资金池变得太大，资金可以退出和赎回，并与较小的提供商重新进行质押。**或者，如果你已经积累了足够的 ETH，你可以在此质押。**

---

4. 奖励支付（部分提款）是否自动执行？

- **是的，只要验证者提供了提款地址。** 地址必须提供一次，才能进行任何提款。每隔几天，每次验证器扫描都会自动触发奖励支付。

--- 

5. 全额提款会自动发生吗？

- **不会，如果验证者仍在网络上活跃，就不会自动地进行完全提款。**
- 这一步需要手动启动自愿退出流程。一旦验证者完成退出过程，并假设帐户具有提款凭据，那么剩余余额将在下一次验证者扫描期间提现。

---


6. 如何提取自定义的金额？

- 提款被设计为自动推送，转移任何不积极贡献权益的 ETH。这包括帐户的全部余额。不能手动要求提取特定数量的 ETH。

---

7. 在哪里可以找到关于操作验证器的更多信息？

- 验证器操作人员建议访问 **Staking Launchpad Withdrawals (Zhejiang Testnet)** 页面，在这里您可以找到更多关于准备工作、活动时间安排以及提款功能的详细信息。

{{< /admonition >}}



---
<center > - END - </center>
























